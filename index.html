<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯’å‡è‡ªå¾‹å¢è‚Œé•¿é«˜æ‰“å¡ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 16px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .tab-container {
            display: flex;
            background: #f1f3f4;
            padding: 0 20px;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .tab.active {
            border-bottom: 3px solid #667eea;
            color: #667eea;
            background: white;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #667eea;
            outline: none;
        }
        
        .meal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .meal-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .checkbox-item {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            display: block;
            width: 100%;
            margin-top: 20px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .records {
            margin-top: 30px;
        }
        
        .record-card {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .record-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .record-date {
            font-weight: bold;
            color: #667eea;
        }
        
        .record-time {
            color: #666;
        }
        
        .record-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .record-section h4 {
            color: #555;
            margin-bottom: 5px;
        }
        
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .password-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .password-input {
            margin: 20px 0;
            padding: 12px;
            width: 100%;
            font-size: 18px;
            text-align: center;
            letter-spacing: 2px;
        }
        
        .password-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            display: none;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .tab-container {
                flex-wrap: wrap;
                padding: 0;
            }
            
            .tab {
                flex: 1;
                min-width: 120px;
                text-align: center;
                padding: 12px 15px;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .meal-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‹ï¸â€â™‚ï¸ å¯’å‡è‡ªå¾‹å¢è‚Œé•¿é«˜æ‰“å¡ç³»ç»Ÿ</h1>
            <p>17å²ä¸“é¡¹è®­ç»ƒè®¡åˆ’ Â· å››å¤©è®­ç»ƒæ³• Â· ç§‘å­¦å¢è‚Œé•¿é«˜</p>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="number" id="totalDays">0</div>
                <div>ç´¯è®¡æ‰“å¡å¤©æ•°</div>
            </div>
            <div class="stat-card">
                <div class="number" id="totalWorkouts">0</div>
                <div>è®­ç»ƒæ¬¡æ•°</div>
            </div>
            <div class="stat-card">
                <div class="number" id="avgSleep">0h</div>
                <div>å¹³å‡ç¡çœ æ—¶é—´</div>
            </div>
            <div class="stat-card">
                <div class="number" id="currentWeek">1</div>
                <div>å½“å‰å‘¨æ¬¡</div>
            </div>
        </div>
        
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('diet')">ğŸ½ï¸ é¥®é£Ÿè®°å½•</div>
            <div class="tab" onclick="switchTab('workout')">ğŸ’ª è¿åŠ¨è®­ç»ƒ</div>
            <div class="tab" onclick="switchTab('sleep')">ğŸ˜´ ç¡çœ ç®¡ç†</div>
            <div class="tab" onclick="switchTab('records')">ğŸ“Š æ‰“å¡è®°å½•</div>
        </div>
        
        <!-- é¥®é£Ÿè®°å½•æ ‡ç­¾ -->
        <div class="tab-content active" id="diet-tab">
            <h2>ä»Šæ—¥é¥®é£Ÿè®°å½•</h2>
            <div class="meal-grid">
                <div class="meal-box">
                    <h3>æ—©é¤ (7:00-8:00)</h3>
                    <div class="form-group">
                        <label>ä¸»è¦é£Ÿç‰©ï¼š</label>
                        <input type="text" id="breakfast-main" placeholder="å¦‚ï¼šç‡•éº¦ã€é¸¡è›‹ã€ç‰›å¥¶">
                    </div>
                    <div class="form-group">
                        <label>è›‹ç™½è´¨æ‘„å…¥(g)ï¼š</label>
                        <input type="number" id="breakfast-protein" min="0" max="100">
                    </div>
                </div>
                
                <div class="meal-box">
                    <h3>åˆé¤ (12:00-13:00)</h3>
                    <div class="form-group">
                        <label>ä¸»è¦é£Ÿç‰©ï¼š</label>
                        <input type="text" id="lunch-main" placeholder="å¦‚ï¼šç±³é¥­ã€é¸¡èƒ¸è‚‰ã€è”¬èœ">
                    </div>
                    <div class="form-group">
                        <label>è›‹ç™½è´¨æ‘„å…¥(g)ï¼š</label>
                        <input type="number" id="lunch-protein" min="0" max="100">
                    </div>
                </div>
                
                <div class="meal-box">
                    <h3>æ™šé¤ (18:00-19:00)</h3>
                    <div class="form-group">
                        <label>ä¸»è¦é£Ÿç‰©ï¼š</label>
                        <input type="text" id="dinner-main" placeholder="å¦‚ï¼šç‰›è‚‰ã€ç³™ç±³ã€è¥¿å…°èŠ±">
                    </div>
                    <div class="form-group">
                        <label>è›‹ç™½è´¨æ‘„å…¥(g)ï¼š</label>
                        <input type="number" id="dinner-protein" min="0" max="100">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>åŠ é¤/è¡¥å‰‚ï¼š</label>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" id="snack-protein"> è›‹ç™½ç²‰
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="snack-fruit"> æ°´æœ
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="snack-nuts"> åšæœ
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="snack-milk"> ç‰›å¥¶
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="snack-other"> å…¶ä»–
                    </label>
                </div>
            </div>
            
            <div class="form-group">
                <label>ä»Šæ—¥æ€»é¥®æ°´é‡(L)ï¼š</label>
                <input type="number" id="water-intake" min="0" max="10" step="0.5" value="2">
            </div>
            
            <button class="btn" onclick="requestPassword()">æäº¤ä»Šæ—¥é¥®é£Ÿè®°å½•</button>
        </div>
        
        <!-- è¿åŠ¨è®­ç»ƒæ ‡ç­¾ -->
        <div class="tab-content" id="workout-tab">
            <h2>ä»Šæ—¥è®­ç»ƒè®°å½•</h2>
            
            <div class="form-group">
                <label>è®­ç»ƒæ—¥é€‰æ‹©ï¼š</label>
                <select id="workout-day">
                    <option value="day1">è®­ç»ƒæ—¥1ï¼šä¸Šè‚¢åŠ›é‡+è·³è·ƒ</option>
                    <option value="day2">è®­ç»ƒæ—¥2ï¼šä¸‹è‚¢+æ ¸å¿ƒ</option>
                    <option value="day3">è®­ç»ƒæ—¥3ï¼šå…¨èº«+æ‹‰ä¼¸</option>
                    <option value="day4">è®­ç»ƒæ—¥4ï¼šæœ‰æ°§+æŸ”éŸ§</option>
                    <option value="rest">ä¼‘æ¯æ—¥</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>è®­ç»ƒé¡¹ç›®ï¼š</label>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" id="exercise-pullup"> å¼•ä½“å‘ä¸Š
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="exercise-pushup"> ä¿¯å§æ’‘
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="exercise-squat"> æ·±è¹²
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="exercise-plank"> å¹³æ¿æ”¯æ’‘
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="exercise-jump"> è·³è·ƒè®­ç»ƒ
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="exercise-stretch"> æ‹‰ä¼¸è¿åŠ¨
                    </label>
                </div>
            </div>
            
            <div class="form-group">
                <label>è®­ç»ƒæ—¶é•¿(åˆ†é’Ÿ)ï¼š</label>
                <input type="number" id="workout-duration" min="0" max="180" value="60">
            </div>
            
            <div class="form-group">
                <label>è®­ç»ƒæ„Ÿå—ï¼š</label>
                <select id="workout-feeling">
                    <option value="excellent">éå¸¸æ£’</option>
                    <option value="good">è‰¯å¥½</option>
                    <option value="normal">ä¸€èˆ¬</option>
                    <option value="tired">æœ‰ç‚¹ç´¯</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>é¢å¤–å¤‡æ³¨ï¼š</label>
                <textarea id="workout-notes" rows="3" placeholder="è®°å½•ç‰¹æ®Šè®­ç»ƒæˆ–æ„Ÿå—..."></textarea>
            </div>
            
            <button class="btn" onclick="requestPassword()">æäº¤ä»Šæ—¥è®­ç»ƒè®°å½•</button>
        </div>
        
        <!-- ç¡çœ ç®¡ç†æ ‡ç­¾ -->
        <div class="tab-content" id="sleep-tab">
            <h2>ç¡çœ è®°å½•</h2>
            
            <div class="form-group">
                <label>æ˜¨æ™šç¡è§‰æ—¶é—´ï¼š</label>
                <input type="time" id="sleep-time" value="22:30">
            </div>
            
            <div class="form-group">
                <label>ä»Šæ—©èµ·åºŠæ—¶é—´ï¼š</label>
                <input type="time" id="wakeup-time" value="06:30">
            </div>
            
            <div class="form-group">
                <label>ç¡çœ è´¨é‡ï¼š</label>
                <select id="sleep-quality">
                    <option value="excellent">éå¸¸å¥½(æ·±åº¦ç¡çœ )</option>
                    <option value="good">è‰¯å¥½</option>
                    <option value="normal">ä¸€èˆ¬</option>
                    <option value="poor">è¾ƒå·®(å¤šæ¢¦æ˜“é†’)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>åˆä¼‘æ—¶é•¿(åˆ†é’Ÿ)ï¼š</label>
                <input type="number" id="nap-duration" min="0" max="120" value="0">
            </div>
            
            <button class="btn" onclick="requestPassword()">æäº¤ç¡çœ è®°å½•</button>
        </div>
        
        <!-- æ‰“å¡è®°å½•æ ‡ç­¾ -->
        <div class="tab-content" id="records-tab">
            <h2>å†å²æ‰“å¡è®°å½•</h2>
            <div class="records" id="records-container">
                <!-- è®°å½•ä¼šåŠ¨æ€åŠ è½½åˆ°è¿™é‡Œ -->
            </div>
            
            <div class="form-group">
                <button class="btn" onclick="exportData()">ğŸ“¥ å¯¼å‡ºæ‰€æœ‰æ•°æ®</button>
                <button class="btn" onclick="clearAllData()" style="background: #dc3545; margin-top: 10px;">âš ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
            </div>
        </div>
    </div>
    
    <!-- å¯†ç å¼¹çª— -->
    <div class="password-modal" id="passwordModal">
        <div class="password-box">
            <h3>ğŸ”’ æ“ä½œå‘˜éªŒè¯</h3>
            <p>è¯·è¾“å…¥å¯†ç ä»¥ç¡®è®¤æäº¤</p>
            <input type="password" class="password-input" id="passwordInput" placeholder="è¾“å…¥å¯†ç ">
            <div style="margin-top: 20px;">
                <button class="password-btn" onclick="checkPassword()">ç¡®è®¤æäº¤</button>
                <button class="password-btn" onclick="closePasswordModal()" style="background: #6c757d; margin-left: 10px;">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
    
    <!-- æç¤ºä¿¡æ¯ -->
    <div class="alert alert-success" id="successAlert">æ‰“å¡æˆåŠŸï¼è®°å½•å·²ä¿å­˜ã€‚</div>
    <div class="alert alert-error" id="errorAlert">å¯†ç é”™è¯¯ï¼è¯·é‡æ–°è¾“å…¥ã€‚</div>

    <script>
        // å¯†ç é…ç½®
        const CORRECT_PASSWORD = "123456ex";
        let currentAction = null;
        
        // åˆå§‹åŒ–æ•°æ®
        let records = JSON.parse(localStorage.getItem('fitnessRecords') || '[]');
        
        // DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            loadRecords();
            updateCurrentWeek();
        });
        
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰activeç±»
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // æ·»åŠ activeç±»åˆ°å¯¹åº”æ ‡ç­¾
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // å¦‚æœæ˜¯è®°å½•æ ‡ç­¾ï¼Œé‡æ–°åŠ è½½è®°å½•
            if(tabName === 'records') {
                loadRecords();
            }
        }
        
        // è¯·æ±‚å¯†ç éªŒè¯
        function requestPassword() {
            // ç¡®å®šå½“å‰åœ¨å“ªä¸ªæ ‡ç­¾é¡µ
            const activeTab = document.querySelector('.tab.active');
            if(activeTab.textContent.includes('é¥®é£Ÿ')) currentAction = 'diet';
            else if(activeTab.textContent.includes('è¿åŠ¨')) currentAction = 'workout';
            else if(activeTab.textContent.includes('ç¡çœ ')) currentAction = 'sleep';
            
            document.getElementById('passwordModal').style.display = 'flex';
            document.getElementById('passwordInput').focus();
        }
        
        // å…³é—­å¯†ç å¼¹çª—
        function closePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
            document.getElementById('passwordInput').value = '';
            currentAction = null;
        }
        
        // æ£€æŸ¥å¯†ç 
        function checkPassword() {
            const inputPassword = document.getElementById('passwordInput').value;
            
            if(inputPassword === CORRECT_PASSWORD) {
                closePasswordModal();
                
                // æ ¹æ®å½“å‰åŠ¨ä½œæ‰§è¡Œç›¸åº”æäº¤
                if(currentAction === 'diet') submitDiet();
                else if(currentAction === 'workout') submitWorkout();
                else if(currentAction === 'sleep') submitSleep();
                
                showAlert('success');
            } else {
                showAlert('error');
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }
        
        // æäº¤é¥®é£Ÿè®°å½•
        function submitDiet() {
            const today = new Date().toISOString().split('T')[0];
            
            // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²æœ‰é¥®é£Ÿè®°å½•
            const existingIndex = records.findIndex(r => r.date === today && r.type === 'diet');
            
            const dietRecord = {
                id: Date.now(),
                date: today,
                type: 'diet',
                breakfast: document.getElementById('breakfast-main').value,
                breakfastProtein: parseInt(document.getElementById('breakfast-protein').value) || 0,
                lunch: document.getElementById('lunch-main').value,
                lunchProtein: parseInt(document.getElementById('lunch-protein').value) || 0,
                dinner: document.getElementById('dinner-main').value,
                dinnerProtein: parseInt(document.getElementById('dinner-protein').value) || 0,
                supplements: {
                    protein: document.getElementById('snack-protein').checked,
                    fruit: document.getElementById('snack-fruit').checked,
                    nuts: document.getElementById('snack-nuts').checked,
                    milk: document.getElementById('snack-milk').checked,
                    other: document.getElementById('snack-other').checked
                },
                water: parseFloat(document.getElementById('water-intake').value) || 0,
                timestamp: new Date().toLocaleString()
            };
            
            if(existingIndex > -1) {
                records[existingIndex] = dietRecord;
            } else {
                records.push(dietRecord);
            }
            
            saveToStorage();
            updateStats();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('breakfast-main').value = '';
            document.getElementById('breakfast-protein').value = '';
            document.getElementById('lunch-main').value = '';
            document.getElementById('lunch-protein').value = '';
            document.getElementById('dinner-main').value = '';
            document.getElementById('dinner-protein').value = '';
            document.querySelectorAll('#diet-tab input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('water-intake').value = '2';
        }
        
        // æäº¤è¿åŠ¨è®°å½•
        function submitWorkout() {
            const today = new Date().toISOString().split('T')[0];
            
            const existingIndex = records.findIndex(r => r.date === today && r.type === 'workout');
            
            const workoutRecord = {
                id: Date.now(),
                date: today,
                type: 'workout',
                day: document.getElementById('workout-day').value,
                exercises: {
                    pullup: document.getElementById('exercise-pullup').checked,
                    pushup: document.getElementById('exercise-pushup').checked,
                    squat: document.getElementById('exercise-squat').checked,
                    plank: document.getElementById('exercise-plank').checked,
                    jump: document.getElementById('exercise-jump').checked,
                    stretch: document.getElementById('exercise-stretch').checked
                },
                duration: parseInt(document.getElementById('workout-duration').value) || 0,
                feeling: document.getElementById('workout-feeling').value,
                notes: document.getElementById('workout-notes').value,
                timestamp: new Date().toLocaleString()
            };
            
            if(existingIndex > -1) {
                records[existingIndex] = workoutRecord;
            } else {
                records.push(workoutRecord);
            }
            
            saveToStorage();
            updateStats();
            
            // é‡ç½®è¡¨å•
            document.querySelectorAll('#workout-tab input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('workout-duration').value = '60';
            document.getElementById('workout-notes').value = '';
        }
        
        // æäº¤ç¡çœ è®°å½•
        function submitSleep() {
            const today = new Date().toISOString().split('T')[0];
            
            const existingIndex = records.findIndex(r => r.date === today && r.type === 'sleep');
            
            const sleepRecord = {
                id: Date.now(),
                date: today,
                type: 'sleep',
                sleepTime: document.getElementById('sleep-time').value,
                wakeupTime: document.getElementById('wakeup-time').value,
                quality: document.getElementById('sleep-quality').value,
                napDuration: parseInt(document.getElementById('nap-duration').value) || 0,
                timestamp: new Date().toLocaleString()
            };
            
            if(existingIndex > -1) {
                records[existingIndex] = sleepRecord;
            } else {
                records.push(sleepRecord);
            }
            
            saveToStorage();
            updateStats();
        }
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveToStorage() {
            localStorage.setItem('fitnessRecords', JSON.stringify(records));
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            const dietRecords = records.filter(r => r.type === 'diet');
            const workoutRecords = records.filter(r => r.type === 'workout' && r.day !== 'rest');
            const sleepRecords = records.filter(r => r.type === 'sleep');
            
            // è®¡ç®—æ€»å¤©æ•°ï¼ˆå»é‡ï¼‰
            const uniqueDates = [...new Set(records.map(r => r.date))];
            document.getElementById('totalDays').textContent = uniqueDates.length;
            
            // è®­ç»ƒæ¬¡æ•°
            document.getElementById('totalWorkouts').textContent = workoutRecords.length;
            
            // å¹³å‡ç¡çœ æ—¶é—´
            if(sleepRecords.length > 0) {
                let totalSleepHours = 0;
                sleepRecords.forEach(record => {
                    const sleep = parseTime(record.sleepTime);
                    const wakeup = parseTime(record.wakeupTime);
                    let hours = wakeup - sleep;
                    if(hours < 0) hours += 24; // å¤„ç†è·¨å¤œ
                    totalSleepHours += hours;
                });
                const avgSleep = (totalSleepHours / sleepRecords.length).toFixed(1);
                document.getElementById('avgSleep').textContent = avgSleep + 'h';
            }
        }
        
        // è§£ææ—¶é—´å­—ç¬¦ä¸²ä¸ºå°æ—¶æ•°
        function parseTime(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours + minutes / 60;
        }
        
        // åŠ è½½è®°å½•
        function loadRecords() {
            const container = document.getElementById('records-container');
            container.innerHTML = '';
            
            if(records.length === 0) {
                container.innerHTML = '<div class="record-card"><p>æš‚æ— æ‰“å¡è®°å½•ï¼Œè¯·å¼€å§‹ä½ çš„ç¬¬ä¸€å¤©æ‰“å¡ï¼</p></div>';
                return;
            }
            
            // æŒ‰æ—¥æœŸåˆ†ç»„
            const recordsByDate = {};
            records.forEach(record => {
                if(!recordsByDate[record.date]) {
                    recordsByDate[record.date] = [];
                }
                recordsByDate[record.date].push(record);
            });
            
            // æŒ‰æ—¥æœŸå€’åºæ’åˆ—
            const sortedDates = Object.keys(recordsByDate).sort().reverse();
            
            sortedDates.forEach(date => {
                const dateRecords = recordsByDate[date];
                const card = document.createElement('div');
                card.className = 'record-card';
                
                let content = `
                    <div class="record-header">
                        <div class="record-date">${formatDate(date)}</div>
                        <div class="record-time">ç¬¬${getWeekNumber(date)}å‘¨</div>
                    </div>
                    <div class="record-content">
                `;
                
                dateRecords.forEach(record => {
                    if(record.type === 'diet') {
                        content += `
                            <div class="record-section">
                                <h4>ğŸ½ï¸ é¥®é£Ÿè®°å½•</h4>
                                <p><strong>æ—©é¤ï¼š</strong>${record.breakfast || 'æœªè®°å½•'} (${record.breakfastProtein || 0}gè›‹ç™½)</p>
                                <p><strong>åˆé¤ï¼š</strong>${record.lunch || 'æœªè®°å½•'} (${record.lunchProtein || 0}gè›‹ç™½)</p>
                                <p><strong>æ™šé¤ï¼š</strong>${record.dinner || 'æœªè®°å½•'} (${record.dinnerProtein || 0}gè›‹ç™½)</p>
                                <p><strong>é¥®æ°´é‡ï¼š</strong>${record.water || 0}L</p>
                            </div>
                        `;
                    } else if(record.type === 'workout') {
                        const exercises = Object.entries(record.exercises)
                            .filter(([_, value]) => value)
                            .map(([key]) => getExerciseName(key))
                            .join('ã€') || 'æ— ';
                        
                        content += `
                            <div class="record-section">
                                <h4>ğŸ’ª è®­ç»ƒè®°å½•</h4>
                                <p><strong>è®­ç»ƒæ—¥ï¼š</strong>${getWorkoutDayName(record.day)}</p>
                                <p><strong>è®­ç»ƒé¡¹ç›®ï¼š</strong>${exercises}</p>
                                <p><strong>æ—¶é•¿ï¼š</strong>${record.duration || 0}åˆ†é’Ÿ</p>
                                <p><strong>æ„Ÿå—ï¼š</strong>${getFeelingText(record.feeling)}</p>
                            </div>
                        `;
                    } else if(record.type === 'sleep') {
                        content += `
                            <div class="record-section">
                                <h4>ğŸ˜´ ç¡çœ è®°å½•</h4>
                                <p><strong>ç¡çœ æ—¶é—´ï¼š</strong>${record.sleepTime} - ${record.wakeupTime}</p>
                                <p><strong>ç¡çœ è´¨é‡ï¼š</strong>${getSleepQualityText(record.quality)}</p>
                                <p><strong>åˆä¼‘ï¼š</strong>${record.napDuration || 0}åˆ†é’Ÿ</p>
                            </div>
                        `;
                    }
                });
                
                content += '</div>';
                card.innerHTML = content;
                container.appendChild(card);
            });
        }
        
        // è¾…åŠ©å‡½æ•°
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return `${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
        }
        
        function getWeekNumber(dateStr) {
            const startDate = new Date('2024-01-22'); // å‡è®¾å¯’å‡å¼€å§‹æ—¥æœŸ
            const currentDate = new Date(dateStr);
            const diffTime = Math.abs(currentDate - startDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return Math.ceil(diffDays / 7);
        }
        
        function getExerciseName(key) {
            const names = {
                pullup: 'å¼•ä½“å‘ä¸Š',
                pushup: 'ä¿¯å§æ’‘',
                squat: 'æ·±è¹²',
                plank: 'å¹³æ¿æ”¯æ’‘',
                jump: 'è·³è·ƒè®­ç»ƒ',
                stretch: 'æ‹‰ä¼¸è¿åŠ¨'
            };
            return names[key] || key;
        }
        
        function getWorkoutDayName(day) {
            const names = {
                day1: 'è®­ç»ƒæ—¥1ï¼šä¸Šè‚¢åŠ›é‡+è·³è·ƒ',
                day2: 'è®­ç»ƒæ—¥2ï¼šä¸‹è‚¢+æ ¸å¿ƒ',
                day3: 'è®­ç»ƒæ—¥3ï¼šå…¨èº«+æ‹‰ä¼¸',
                day4: 'è®­ç»ƒæ—¥4ï¼šæœ‰æ°§+æŸ”éŸ§',
                rest: 'ä¼‘æ¯æ—¥'
            };
            return names[day] || day;
        }
        
        function getFeelingText(feeling) {
            const texts = {
                excellent: 'éå¸¸æ£’',
                good: 'è‰¯å¥½',
                normal: 'ä¸€èˆ¬',
                tired: 'æœ‰ç‚¹ç´¯'
            };
            return texts[feeling] || feeling;
        }
        
        function getSleepQualityText(quality) {
            const texts = {
                excellent: 'éå¸¸å¥½',
                good: 'è‰¯å¥½',
                normal: 'ä¸€èˆ¬',
                poor: 'è¾ƒå·®'
            };
            return texts[quality] || quality;
        }
        
        function updateCurrentWeek() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('currentWeek').textContent = getWeekNumber(today);
        }
        
        // å¯¼å‡ºæ•°æ®
        function exportData() {
            const dataStr = JSON.stringify(records, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `fitness-records-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('æ•°æ®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶ï¼');
        }
        
        // æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼ˆéœ€è¦å¯†ç ç¡®è®¤ï¼‰
        function clearAllData() {
            if(confirm('âš ï¸ ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                const password = prompt('è¯·è¾“å…¥æ“ä½œå‘˜å¯†ç ä»¥ç¡®è®¤æ¸…ç©ºï¼š');
                if(password === CORRECT_PASSWORD) {
                    localStorage.removeItem('fitnessRecords');
                    records = [];
                    updateStats();
                    loadRecords();
                    alert('æ‰€æœ‰æ•°æ®å·²æ¸…ç©ºï¼');
                } else {
                    alert('å¯†ç é”™è¯¯ï¼Œæ“ä½œå–æ¶ˆï¼');
                }
            }
        }
        
        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        function showAlert(type) {
            const alert = document.getElementById(type === 'success' ? 'successAlert' : 'errorAlert');
            alert.style.display = 'block';
            setTimeout(() => {
                alert.style.display = 'none';
            }, 3000);
        }
        
        // é˜²æ­¢å³é”®æŸ¥çœ‹æºä»£ç 
        document.addEventListener('contextmenu', function(e) {
            if(e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
            }
        });
        
        // é˜²æ­¢F12é”®
        document.addEventListener('keydown', function(e) {
            if(e.key === 'F12') {
                e.preventDefault();
                alert('æ“ä½œå‘˜æ‚¨å¥½ï¼æºä»£ç å·²åŠ å¯†ä¿æŠ¤ã€‚å¦‚éœ€ç»´æŠ¤è¯·è”ç³»ç®¡ç†å‘˜ã€‚');
            }
        });
    </script>
</body>
</html>